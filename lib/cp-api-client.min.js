!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(3),a=r(u),i=n(1),s=r(i),l=function(){var e=new Headers;return e.append("Content-Type","application/json"),e.append("Accept","application/json"),e.append("X-API-Session",s.default.token()),e},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.default.config().baseURL+e,r=Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");return 0===r.length?n:n+"?"+r},d=function(e){if(401===e.status)throw new Error("unauthenticated");return new Promise(function(t){t(e)})},f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=JSON.stringify(n.postData),o=0;return fetch(c(t,n.urlParams),{method:e,headers:l(),credentials:"same-origin",body:r}).then(function(e){return o=e.status,e.json()}).then(function(e){return new Promise(function(t){t({status:o,data:e})})})},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f("get",e,o({urlParams:t},n))},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f("post",e,o({postData:t},n))},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f("delete",e,t)};t.default={handleUnauthenticated:d,request:f,get:p,post:v,destroy:g},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=null,o=function(e){r=e},u=function(){},a=function(){return r};t.default={isAuthenticated:u,token:a,setToken:o},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=null,o=function(){return null!==r},u=function(){return o&&"specialty"in r},a=function(){return!u()},i=function(e){r=Object.assign({},e)},s=function(){return r};t.default={user:s,setCurrentUser:i,isAuthenticated:o,isClinician:u,isPatient:a},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={baseURL:"http://captureproof.makstep.ru/api/v1",storage:"mem"},o=function(){return r},u=function(e,t){return r[e]=t,r};t.default={config:o,setConfigParam:u},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),u=r(o),a=n(6),i=r(a),s=n(7),l=r(s),c=n(8),d=r(c),f=n(9),p=r(f),v=n(10),g=r(v),_=n(3),y=r(_),h=n(2),m=r(h),b=n(1),P=r(b),w=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return u.default.create(e,t).then(function(e){return 200===e.status&&(P.default.setToken(e.data.token),e.data.hasOwnProperty("clinician")&&m.default.setCurrentUser(e.data.clinician),e.data.hasOwnProperty("patient")&&m.default.setCurrentUser(e.data.patient)),new Promise(function(t){t(e)})})},O=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return u.default.destroy()},j=function(e){y.default.setConfigParam("baseURL",e)};t.default={setApiBaseURL:j,login:w,logout:O,isAuthenticated:m.default.isAuthenticated,currentUser:{user:m.default.user,isPatient:m.default.isPatient,isClinician:m.default.isClinician},upload:g.default,resources:{proofs:i.default,patients:l.default,notes:p.default,captures:d.default}},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=r(o),a=n(1),i=r(a),s=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return u.default.post("/sessions",{email:e,password:t,app_id:"captureproof api"})},l=function(){return u.default.destroy("/sessions/"+i.default.token())};t.default={create:s,destroy:l},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),u=r(o),a=n(0),i=r(a),s=function(e,t){return"/patients/"+e+"/proofs"},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.hasOwnProperty("short")&&e.short?{}:{include:e.include?e.include:"captures,notes,surveys,proof_surveys"}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null===e&&u.default.isPatient()&&(e=u.default.user().id),u.default.isPatient()&&u.default.user().id!==e?(console.error("Error: unable to get proof list for other patient"),[]):i.default.get(s(e),l())},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t){if(u.default.isClinician())return console.error("Error: no patientID provided."),[];t=u.default.user().id}return i.default.get(s(t)+"/"+e,l())};t.default={list:c,get:d},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=r(o),a=n(2),i=r(a),s=function(){return i.default.isPatient()?(console.error("Error: this call is not allowed for patient."),[]):u.default.get("/patients")},l=function(e){return i.default.isPatient()?(console.error("Error: this call is not allowed for patient."),[]):u.default.get("/patients"+e)};t.default={list:s,get:l},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e,t){return"/patients/"+e+"/proofs/"+t+"/captures"},u=function(e){return{description:e.description,upload_s3_key:e.upload_s3_key,library_item_id:e.library_item_id,media:e.media,camera_type:e.camera_type,metadata:e.metadata}},a=function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,r.post)(o(e,t,u(n)))};t.default={create:a},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e,t){return"/patients/"+e+"/proofs/"+t+"/notes"},u=function(e){return{body:e.body,only_visible_to_clinicians:e.only_visible_to_clinicians}},a=function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,r.post)(o(e,t),u(n))};t.default={create:a},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o="instructional_meduim",u={};u.capture=null,u.protocol_logo=null,u[o]=null;var a=function(e,t){if(null!==u[e])return u[e];var n="";switch(e){case o:n="/instructional_media/new";break;case"protocol_logo":n="/protocols/new";break;default:n="/patients/fake_patient_id/proofs/fake_proof_id/captures/new"}return(0,r.get)(n).then(function(n){200===n.status&&(u[e]=n.data,t())}),null},i=function(e){switch(e.split(".").pop().toLowerCase()){case"mpg":case"mpeg":return"video/mpeg";case"mov":return"video/quicktime";case"mp4":return"video/mp4";case"m4v":return"video/m4v";case"3gp":return"video/3gp";case"avi":return"video/avi";case"wmv":return"video/x-ms-wmv";case"png":return"image/png";default:return"image/jpg"}},s=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("Upload!!!");var o=new FormData,u=new XMLHttpRequest,s=a(t,function(){e(t,n,r)});return null===s?"":(s.key=s.key.replace("{extension}",n.name.split(".").pop()),o.append("utf8","âœ“"),o.append("x-amz-server-side-encryption","AES256"),o.append("key",s.key),o.append("acl",s.acl),o.append("AWSAccessKeyId",s.AWSAccessKeyId),o.append("policy",s.policy),o.append("signature",s.signature),o.append("success_action_status",s.success_action_status),o.append("X-Requested-With","xhr"),o.append("content-type",i(n.name)),o.append("file",n),u.open("POST",s.action_url),u.upload.addEventListener("progress",function(e){e.lengthComputable&&"function"==typeof r.progress&&r.progress(e.loaded,e.total)}),u.onloadstart=function(e){"function"==typeof r.start&&r.start(e)},u.onloadend=function(e){"function"==typeof r.success&&r.success(s.key,e)},u.onerror=function(e){"function"==typeof r.error&&r.error(e)},u.send(o),s.key)},l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];s("capture",e)},c=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];s("protocol_logo",e)},d=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(o,e)};t.default={capture:l,protocolLogo:c,instructionalMedium:d},e.exports=t.default}]));