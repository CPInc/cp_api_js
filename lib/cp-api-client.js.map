{"version":3,"sources":["webpack:///webpack/bootstrap 40e8a29998419bca6a0d","webpack:///./src/request.js","webpack:///./src/auth.js","webpack:///./src/current_user.js","webpack:///./src/index.js","webpack:///./src/resources/session.js","webpack:///./src/config.js","webpack:///./src/resources/proofs.js","webpack:///./src/resources/patients.js","webpack:///./src/resources/captures.js","webpack:///./src/resources/notes.js","webpack:///./src/upload.js"],"names":["requestHeaders","headers","Headers","append","token","fullURL","path","urlParams","url","paramsString","Object","keys","map","key","encodeURIComponent","join","length","handleUnauthenticated","response","status","Error","Promise","resolve","request","method","opts","body","JSON","stringify","postData","fetch","credentials","then","json","data","get","post","destroy","authToken","setToken","_token","isAuthenticated","loggedUser","isClinician","hasOwnProperty","isPatient","setCurrentUser","currentUser","assign","user","login","email","password","create","console","log","clinician","patient","logout","upload","resources","proofs","patients","notes","captures","authPath","baseURL","storage","basePath","patientID","short","include","list","error","id","proofID","prepareEntity","capture","description","upload_s3_key","library_item_id","media","camera_type","metadata","note","only_visible_to_clinicians","TYPE_CAPTURE","TYPE_PROTOCOL_LOGO","TYPE_IM","getCredentialsFor","type","callback","guessMimeType","filename","ext","split","pop","toLowerCase","file","formData","FormData","xhr","XMLHttpRequest","creds","replace","name","acl","AWSAccessKeyId","policy","signature","success_action_status","open","action_url","addEventListener","event","lengthComputable","progress","loaded","total","onloadstart","e","start","onloadend","success","onerror","send","protocolLogo","instructionalMedium"],"mappings":"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","file":"cp-api-client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 40e8a29998419bca6a0d","import { baseURL } from './config';\nimport Auth from './auth';\n\nconst requestHeaders = () => {\n  let headers = new Headers();\n\n  headers.append('Content-Type', 'application/json');\n  headers.append('Accept', 'application/json');\n  headers.append('X-API-Session', Auth.token());\n\n  return headers;\n};\n\nconst fullURL = (path, urlParams = {}) => {\n  const url = baseURL + path;\n  const paramsString = Object.keys(urlParams).map((key) => {\n    return encodeURIComponent(key) + '=' + encodeURIComponent(urlParams[key]);\n  }).join('&');\n\n  return paramsString.length === 0 ? url : url + '?' + paramsString;\n};\n\n// Public\n\nconst handleUnauthenticated = (response) => {\n  if (response.status === 401) {\n    throw new Error('unauthenticated');\n  }\n  return new Promise((resolve) => {\n    resolve(response);\n  });\n};\n\n// opts:\n//   urlParams - params for url\n//   postData - post data to send\nconst request = (method, path, opts = {}) => {\n  const body = JSON.stringify(opts.postData);\n  let status = 0;\n\n  return fetch(fullURL(path, opts.urlParams), {\n    method: method,\n    headers: requestHeaders(),\n    credentials: 'same-origin',\n    body\n  })\n    .then(response => {\n      status = response.status;\n      return response.json();\n    })\n    .then(data => {\n      return new Promise((resolve) => {\n        resolve({ status, data });\n      });\n    });\n};\n\nconst get = (path, urlParams = {}, opts = {}) => {\n  return request('get', path, { urlParams, ...opts });\n};\n\nconst post = (path, postData = {}, opts = {}) => {\n  return request('post', path, { postData, ...opts });\n};\n\nconst destroy = (path, opts = {}) => {\n  return request('delete', path, opts);\n};\n\nexport default {\n  handleUnauthenticated,\n  request,\n  get,\n  post,\n  destroy\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/request.js","let authToken = null;\n\nconst setToken = (_token) => { authToken = _token; };\nconst isAuthenticated = () => { authToken === null; };\nconst token = () => { return authToken; };\n\nexport default {\n  isAuthenticated,\n  token,\n  setToken\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/auth.js","let loggedUser = null;\n\nconst isAuthenticated = () => { return loggedUser === null; };\nconst isClinician = () => { return loggedUser.hasOwnProperty('specialty'); };\nconst isPatient = () => { return !isClinician(); };\nconst setCurrentUser = (currentUser) => { loggedUser = Object.assign({}, currentUser); };\nconst user = () => { return loggedUser; };\n\nexport default {\n  user,\n  setCurrentUser,\n  isAuthenticated,\n  isClinician,\n  isPatient\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/current_user.js","import session from './resources/session';\nimport proofs from './resources/proofs';\nimport patients from './resources/patients';\nimport captures from './resources/captures';\nimport notes from './resources/notes';\n\nimport upload from './upload';\n\nimport CurrentUser from './current_user';\nimport Auth from './auth';\n\nconst login = (email, password, opts = {}) => {\n  return session.create(email, password)\n    .then((response) => {\n      console.log('Response ', response);\n      if (response.status === 200) {\n        Auth.setToken(response.data.token);\n\n        if (response.data.hasOwnProperty('clinician')) {\n          CurrentUser.setCurrentUser(response.data.clinician);\n        };\n\n        if (response.data.hasOwnProperty('patient')) {\n          CurrentUser.setCurrentUser(response.data.patient);\n        };\n      }\n    });\n};\n\nconst logout = (opts = {}) => {\n  return session.destroy();\n};\n\nexport default {\n  login,\n  logout,\n  isAuthenticated: CurrentUser.isAuthenticated,\n  currentUser: {\n    user: CurrentUser.user,\n    isPatient: CurrentUser.isPatient,\n    isClinician: CurrentUser.isClinician\n  },\n  upload,\n  resources: {\n    proofs,\n    patients,\n    notes,\n    captures\n  }\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Request from '../request';\nimport Auth from '../auth';\n\nconst authPath = '/sessions';\n\nconst create = (email, password, opts = {}) => {\n  return Request.post(authPath, {\n    email,\n    password,\n    'app_id': 'captureproof api'\n  });\n};\n\nconst destroy = () => {\n  return Request.destroy(authPath + '/' + Auth.token());\n};\n\nexport default {\n  create,\n  destroy\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/session.js","export default {\n  baseURL: 'http://captureproof.makstep.ru/api/v1',\n  storage: 'mem' // mem (default), localstorage, cookie\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","import CurrentUser from '../current_user';\nimport Request from '../request';\n\nconst basePath = (patientID, path) => { return '/patients/' + patientID + '/proofs'; };\n\nconst urlParams = (opts = {}) => {\n  return (opts.hasOwnProperty('short') && opts.short) ?\n    {} :\n    { include: opts.include ? opts.include : 'captures,notes,surveys,proof_surveys' };\n};\n\n// Path: /patients/<patien_id>/proofs\nconst list = (patientID = null, opts = {}) => {\n  if (CurrentUser.isClinician()) {\n    console.error('Error: this call only allowed for patient.');\n    return [];\n  }\n\n  if (patientID === null && CurrentUser.isPatient()) {\n    patientID = CurrentUser.user().id;\n  }\n\n  if (CurrentUser.isPatient() && CurrentUser.user().id !== patientID) {\n    console.error('Error: unable to get proof list for other patient');\n    return [];\n  }\n\n  return Request.get(basePath(patientID), urlParams());\n};\n\n// Path: /patients/<patien_id>/proofs/<proof_id>\nconst get = (proofID, patientID = null) => {\n  if (patientID === null) {\n    if (CurrentUser.isClinician()) {\n      console.error('Error: no patientID provided.');\n      return [];\n    }\n    patientID = CurrentUser.user().id;\n  }\n\n  return Request.get(basePath(patientID) + '/' + proofID, urlParams());\n};\n\nexport default {\n  list,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/proofs.js","import Request from '../request';\nimport CurrentUser from '../current_user';\n\nconst basePath = '/patients';\n\nconst list = () => {\n  if (CurrentUser.isPatient()) {\n    console.error('Error: this call is not allowed for patient.');\n    return [];\n  }\n\n  return Request.get(basePath);\n};\n\nconst get = (patientID) => {\n  if (CurrentUser.isPatient()) {\n    console.error('Error: this call is not allowed for patient.');\n    return [];\n  }\n\n  return Request.get(basePath + patientID);\n};\n\nexport default {\n  list,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/patients.js","import { post } from '../request';\n\nconst basePath = (patientID, proofID) => {\n  return '/patients/' + patientID + '/proofs/' + proofID + '/captures';\n};\n\n/* eslint-disable camelcase */\nconst prepareEntity = (capture) => {\n  const {\n    description,\n    upload_s3_key,\n    library_item_id,\n    media,\n    camera_type,\n    metadata } = capture;\n\n  return {\n    description,\n    upload_s3_key,\n    library_item_id,\n    media,\n    camera_type,\n    metadata\n  };\n};\n/* eslint-enable camelcase */\n\nconst create = (patientID, proofID, capture, opts = {}) => {\n  return post(basePath(patientID, proofID, prepareEntity(capture)));\n};\n\nexport default { create };\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/captures.js","import { post } from '../request';\n\nconst url = (patientID, proofID) =>\n  '/patients/' + patientID + '/proofs/' + proofID + '/notes';\n\n/* eslint-disable camelcase */\nconst prepareEntity = (note) => {\n  return {\n    body: note.body,\n    only_visible_to_clinicians: note.only_visible_to_clinicians\n  };\n};\n/* eslint-enable camelcase */\n\nconst create = (patientID, proofID, note, opts = {}) => {\n  return post(url(patientID, proofID), prepareEntity(note));\n};\n\nexport default { create };\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/notes.js","import { get } from './request';\n\nconst TYPE_CAPTURE = 'capture';\nconst TYPE_PROTOCOL_LOGO = 'protocol_logo';\nconst TYPE_IM = 'instructional_meduim';\n\nlet credentials = {};\n\ncredentials[TYPE_CAPTURE] = null;\ncredentials[TYPE_PROTOCOL_LOGO] = null;\ncredentials[TYPE_IM] = null;\n\nconst getCredentialsFor = (type, callback) => {\n  if (credentials[type] !== null) {\n    return credentials[type];\n  }\n\n  let path = '';\n\n  switch (type) {\n    case TYPE_IM:\n      path = '/instructional_media/new';\n      break;\n    case TYPE_PROTOCOL_LOGO:\n      path = '/protocols/new';\n      break;\n    default: // Captures\n      path = '/patients/fake_patient_id/proofs/fake_proof_id/captures/new';\n  }\n\n  get(path)\n    .then((response) => {\n      if (response.status !== 200) { return; }\n      credentials[type] = response.data;\n      callback();\n    });\n\n  return null;\n};\n\n// Naive one, needs to be changed\nconst guessMimeType = (filename) => {\n  var ext = filename.split('.').pop();\n\n  switch (ext.toLowerCase()) {\n    case 'mpg':\n    case 'mpeg':\n      return 'video/mpeg';\n    case 'mov':\n      return 'video/quicktime';\n    case 'mp4':\n      return 'video/mp4';\n    case 'm4v':\n      return 'video/m4v';\n    case '3gp':\n      return 'video/3gp';\n    case 'avi':\n      return 'video/avi';\n    case 'wmv':\n      return 'video/x-ms-wmv';\n    case 'png':\n      return 'image/png';\n    default:\n      return 'image/jpg';\n  }\n};\n\nconst upload = (type, file, opts = {}) => {\n  console.log('Upload!!!');\n  let\n    formData = new FormData(),\n    xhr = new XMLHttpRequest();\n\n  // If creds is not loaded yet, then schedule function execution after\n  let creds = getCredentialsFor(type, () => { upload(type, file, opts); });\n\n  if (creds === null) { return ''; }\n\n  creds.key = creds.key.replace('{extension}', file.name.split('.').pop());\n\n  formData.append('utf8', '✓');\n  formData.append('x-amz-server-side-encryption', 'AES256');\n  formData.append('key', creds.key);\n  formData.append('acl', creds.acl);\n  formData.append('AWSAccessKeyId', creds.AWSAccessKeyId);\n  formData.append('policy', creds.policy);\n  formData.append('signature', creds.signature);\n  formData.append('success_action_status', creds.success_action_status);\n  formData.append('X-Requested-With', 'xhr');\n  formData.append('content-type', guessMimeType(file.name));\n  formData.append('file', file);\n\n  xhr.open('POST', creds.action_url);\n\n  xhr.upload.addEventListener('progress', (event) => {\n    if (event.lengthComputable &&\n        typeof opts.progress === 'function') {\n\n      opts.progress(event.loaded, event.total);\n    };\n  });\n\n  xhr.onloadstart = (e) => {\n    if (typeof opts.start === 'function') {\n      opts.start(e);\n    }\n  };\n\n  xhr.onloadend = (e) => {\n    if (typeof opts.success === 'function') {\n      opts.success(creds.key, e);\n    }\n  };\n\n  xhr.onerror = (e) => {\n    if (typeof opts.error === 'function') {\n      opts.error(e);\n    }\n  };\n\n  xhr.send(formData);\n\n  return creds.key;\n};\n\nconst capture = (file, opts = {}) => { upload(TYPE_CAPTURE, file); };\nconst protocolLogo = (file, opts = {}) => { upload(TYPE_PROTOCOL_LOGO, file); };\nconst instructionalMedium = (file, opts = {}) => { upload(TYPE_IM, file); };\n\nexport default {\n  capture,\n  protocolLogo,\n  instructionalMedium\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/upload.js"],"sourceRoot":""}