{"version":3,"sources":["webpack:///webpack/bootstrap 45abb59b86c62ea602ed","webpack:///./src/auth.js","webpack:///./src/request.js","webpack:///./src/patients.js","webpack:///./src/index.js","webpack:///./src/config.js","webpack:///./src/proofs.js"],"names":["authPath","AuthData","authResponse","clinican","userType","user","clinician","patient","token","authData","isClinician","isPatient","authenticate","email","password","opts","post","then","response","status","setAuthToken","data","Promise","resolve","catch","error","console","log","isAuthenticated","authToken","requestHeaders","headers","Headers","append","fullURL","path","params","url","paramsString","Object","keys","map","key","encodeURIComponent","join","length","handleUnauthenticated","Error","handleJson","json","request","method","body","JSON","stringify","postData","fetch","urlParams","credentials","get","basePath","all","patientID","proofs","id","proof","proofID","auth","baseURL"],"mappings":"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","file":"cp-api-client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 45abb59b86c62ea602ed","import Request from './request';\n\nconst authPath = '/sessions';\n\nclass AuthData {\n  constructor(authResponse) {\n    if (authResponse.clinican) {\n      this.userType = 'clinician';\n      this.user = authResponse.clinician;\n    } else {\n      this.userType = 'patient';\n      this.user = authResponse.patient;\n    }\n    this.token = authResponse.token;\n  }\n\n  get isAuthenticated() {\n    return !!this.token;\n  }\n\n  get isClinician() {\n    return this.userType === 'clinician';\n  }\n\n  get isPatient() {\n    return this.userType === 'patient';\n  }\n\n};\n\nlet authData = null;\n\nconst isClinician = () => {\n  return authData && authData.isClinician;\n};\n\nconst isPatient = () => {\n  return authData && authData.isPatient;\n};\n\nconst user = () => {\n  return authData;\n};\n\nconst userType = () => {\n  return authData.userType;\n};\n\nconst authenticate = (email, password, opts = {}) => {\n  return Request.post(authPath, {\n    email,\n    password,\n    'app_id': 'captureproof api'\n  })\n    .then((response) => {\n      if (response.status === 200) {\n        Request.setAuthToken(response.data.token);\n        authData = new AuthData(response.data);\n      }\n\n      return new Promise(resolve => {\n        resolve(response);\n      });\n    })\n    .catch((error) => {\n      Request.setAuthToken('');\n      authData = null;\n      console.log('Fucked up: ', error);\n    });\n};\n\nconst isAuthenticated = () => {\n  return authData && authData.isAuthenticated;\n};\n\nexport default {\n  authenticate,\n  isClinician,\n  isPatient,\n  isAuthenticated,\n  userType,\n  user\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/auth.js","import { baseURL } from './config';\n\nlet authToken = null;\n\nconst requestHeaders = () => {\n  let headers = new Headers();\n\n  headers.append('Content-Type', 'application/json');\n  headers.append('Accept', 'application/json');\n  headers.append('X-API-Session', authToken);\n\n  return headers;\n};\n\nconst fullURL = (path, params = {}) => {\n  const url = baseURL + path;\n  const paramsString = Object.keys(params).map((key) => {\n    return encodeURIComponent(key) + '=' + encodeURIComponent(params[key]);\n  }).join('&');\n\n  return paramsString.length === 0 ? url : baseURL + '?' + paramsString;\n};\n\n// Public\n\nconst handleUnauthenticated = (response) => {\n  if (response.status === 401) {\n    throw new Error('unauthenticated');\n  }\n  return new Promise((resolve) => {\n    resolve(response);\n  });\n};\n\nconst setAuthToken = (token) => {\n  authToken = token;\n};\n\nconst handleJson = (response) => {\n  return response.json();\n};\n\nconst request = (method, path, opts = {}) => {\n  const body = JSON.stringify(opts.postData);\n  let status = 0;\n\n  return fetch(fullURL(path, opts.urlParams), {\n    method: method,\n    headers: requestHeaders(),\n    credentials: 'same-origin',\n    body\n  })\n    .then(response => {\n      status = response.status;\n      return response.json();\n    })\n    .then(data => {\n      return new Promise((resolve) => {\n        resolve({ status, data });\n      });\n    });\n};\n\nconst get = (path, urlParams) => {\n  return request('get', path, { urlParams });\n};\n\nconst post = (path, postData = {}) => {\n  return request('post', path, { postData });\n};\n\nexport default {\n  setAuthToken,\n  handleJson,\n  handleUnauthenticated,\n  request,\n  get,\n  post\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/request.js","import Request from './request';\nimport Auth, { isClinician } from './auth';\n\nconst basePath = '/patients/';\n\nconst all = () => {\n  return Request.get(basePath);\n};\n\nconst get = (patientID) => {\n  if (Auth.isPatient) {\n    return null;\n  }\n\n  return Request.get(basePath + patientID)\n    .then(Request.handleJson);\n};\n\nconst proofs = (patientID = null) => {\n  if (patientID === null && Auth.isPatient) {\n    patientID = Auth.user.id;\n  }\n\n  return Request.get(basePath + patientID + '/proofs/')\n    .then(Request.handleJson);\n};\n\nconst proof = (proofID, patientID = null) => {\n  if (patientID === null) {\n    if (isClinician) { return null; }\n    patientID = Auth.user.id;\n  }\n\n  return Request.get(basePath + patientID + '/proofs/')\n    .then(Request.handleJson);\n};\n\nexport default {\n  all,\n  get,\n  proofs,\n  proof\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/patients.js","import auth from './auth';\nimport proof from './proofs';\nimport patient from './patients';\n\nexport {\n  auth,\n  proof,\n  patient\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export default {\n  baseURL: 'http://captureproof.makstep.ru/api/v1'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","import Auth, { isPatient, isClinician } from './auth';\nimport Patient from './patients';\n\nconst all = (patientID = null) => {\n  if (isClinician()) { return []; }\n  if (isPatient() && Auth.user.id !== patientID) { return []; }\n\n  return Patient.proofs(patientID);\n};\n\nconst get = (proofID, patientID = null) => {\n  if (patientID === null) {\n    if (isClinician()) { return null; }\n    patientID = Auth.user.id;\n  }\n  console.log('!!!!! ', patientID);\n  return Patient.proof(proofID, patientID);\n};\n\nexport default {\n  all,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/proofs.js"],"sourceRoot":""}