{"version":3,"sources":["webpack:///webpack/bootstrap c4638aba04146ed7d3e1","webpack:///./src/auth.js","webpack:///./src/current_user.js","webpack:///./src/request.js","webpack:///./src/resources/patients.js","webpack:///./src/index.js","webpack:///./src/resources/session.js","webpack:///./src/config.js","webpack:///./src/resources/proofs.js"],"names":["authToken","setToken","_token","isAuthenticated","token","loggedUser","isClinician","hasOwnProperty","isPatient","setCurrentUser","currentUser","Object","assign","user","requestHeaders","headers","Headers","append","fullURL","path","params","url","paramsString","keys","map","key","encodeURIComponent","join","length","handleUnauthenticated","response","status","Error","Promise","resolve","request","method","opts","body","JSON","stringify","postData","fetch","urlParams","credentials","then","json","data","get","post","destroy","basePath","list","console","log","patientID","login","email","password","create","clinician","patient","logout","Auth","resources","proofs","patients","authPath","baseURL","storage","id","proofID"],"mappings":"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","file":"cp-api-client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c4638aba04146ed7d3e1","let authToken = null;\n\nconst setToken = (_token) => { authToken = _token; };\nconst isAuthenticated = () => { authToken === null; };\nconst token = () => { return authToken; };\n\nexport default {\n  isAuthenticated,\n  token,\n  setToken\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/auth.js","let loggedUser = null;\n\nconst isAuthenticated = () => { return loggedUser === null; };\nconst isClinician = () => { return loggedUser.hasOwnProperty('specialty'); };\nconst isPatient = () => { return !isClinician(); };\nconst setCurrentUser = (currentUser) => { loggedUser = Object.assign({}, currentUser); };\nconst user = () => { return loggedUser; };\n\nexport default {\n  user,\n  setCurrentUser,\n  isAuthenticated,\n  isClinician,\n  isPatient\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/current_user.js","import { baseURL } from './config';\nimport Auth from './auth';\n\nconst requestHeaders = () => {\n  let headers = new Headers();\n\n  headers.append('Content-Type', 'application/json');\n  headers.append('Accept', 'application/json');\n  headers.append('X-API-Session', Auth.token());\n\n  return headers;\n};\n\nconst fullURL = (path, params = {}) => {\n  const url = baseURL + path;\n  const paramsString = Object.keys(params).map((key) => {\n    return encodeURIComponent(key) + '=' + encodeURIComponent(params[key]);\n  }).join('&');\n\n  return paramsString.length === 0 ? url : baseURL + '?' + paramsString;\n};\n\n// Public\n\nconst handleUnauthenticated = (response) => {\n  if (response.status === 401) {\n    throw new Error('unauthenticated');\n  }\n  return new Promise((resolve) => {\n    resolve(response);\n  });\n};\n\nconst request = (method, path, opts = {}) => {\n  const body = JSON.stringify(opts.postData);\n  let status = 0;\n\n  return fetch(fullURL(path, opts.urlParams), {\n    method: method,\n    headers: requestHeaders(),\n    credentials: 'same-origin',\n    body\n  })\n    .then(response => {\n      status = response.status;\n      return response.json();\n    })\n    .then(data => {\n      return new Promise((resolve) => {\n        resolve({ status, data });\n      });\n    });\n};\n\nconst get = (path, urlParams) => {\n  return request('get', path, { urlParams });\n};\n\nconst post = (path, postData = {}) => {\n  return request('post', path, { postData });\n};\n\nconst destroy = (path, opts = {}) => {\n  return request('delete', path);\n};\n\nexport default {\n  handleUnauthenticated,\n  request,\n  get,\n  post,\n  destroy\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/request.js","import Request from '../request';\nimport CurrentUser from '../current_user';\n\nconst basePath = '/patients/';\n\nconst list = () => {\n  if (CurrentUser.isPatient()) {\n    console.log('Error: this call is not allowed for patient.');\n    return [];\n  }\n\n  return Request.get(basePath);\n};\n\nconst get = (patientID) => {\n  if (CurrentUser.isPatient()) {\n    console.log('Error: this call is not allowed for patient.');\n    return [];\n  }\n\n  return Request.get(basePath + patientID);\n};\n\nexport default {\n  list,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/patients.js","import session from './resources/session';\nimport proofs from './resources/proofs';\nimport patients from './resources/patients';\n\nimport CurrentUser from './current_user';\nimport Auth from './auth';\n\nconst login = (email, password, opts = {}) => {\n  return session.create(email, password)\n    .then((response) => {\n      console.log('Response ', response);\n      if (response.status === 200) {\n        Auth.setToken(response.data.token);\n\n        if (response.data.hasOwnProperty('clinician')) {\n          CurrentUser.setCurrentUser(response.data.clinician);\n        };\n\n        if (response.data.hasOwnProperty('patient')) {\n          CurrentUser.setCurrentUser(response.data.patient);\n        };\n      }\n    });\n};\n\nconst logout = (opts = {}) => {\n  return session.destroy();\n};\n\nexport default {\n  login,\n  logout,\n  Auth,\n  currentUser: {\n    user: CurrentUser.user,\n    isPatient: CurrentUser.isPatient,\n    isClinician: CurrentUser.isClinician,\n    isAuthenticated: CurrentUser.isAuthenticated\n  },\n  resources: {\n    proofs,\n    patients\n  }\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Request from '../request';\nimport Auth from '../auth';\n\nconst authPath = '/sessions';\n\nconst create = (email, password, opts = {}) => {\n  return Request.post(authPath, {\n    email,\n    password,\n    'app_id': 'captureproof api'\n  });\n};\n\nconst destroy = () => {\n  return Request.destroy(authPath + '/' + Auth.token());\n};\n\nexport default {\n  create,\n  destroy\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/session.js","export default {\n  baseURL: 'http://captureproof.makstep.ru/api/v1',\n  storage: 'mem' // mem (default), localstorage, cookie\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","import CurrentUser from '../current_user';\nimport Request from '../request';\n\nconst basePath = (patientID, path) => { return '/patients/' + patientID + '/proofs'; };\n\nconst list = (patientID = null) => {\n  if (CurrentUser.isClinician()) {\n    console.log('Error: this call only allowed for patient.');\n    return [];\n  }\n\n  if (patientID === null && CurrentUser.isPatient()) {\n    patientID = CurrentUser.user.id;\n  }\n\n  if (CurrentUser.isPatient() && CurrentUser.user.id !== patientID) {\n    console.log('Error: unable to get proof list for other patient');\n    return [];\n  }\n\n  return Request.get(basePath(patientID));\n};\n\nconst get = (proofID, patientID = null) => {\n  if (patientID === null) {\n    if (CurrentUser.isClinician()) {\n      console.log('Error: no patientID provided.');\n      return [];\n    }\n    patientID = CurrentUser.user.id;\n  }\n\n  return Request.get(basePath(patientID) + '/' + proofID);\n};\n\nexport default {\n  list,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/proofs.js"],"sourceRoot":""}