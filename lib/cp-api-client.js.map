{"version":3,"sources":["webpack:///webpack/bootstrap 2f02fc55b7340e3169fa","webpack:///./src/request.js","webpack:///./src/auth.js","webpack:///./src/current_user.js","webpack:///./src/config.js","webpack:///./src/index.js","webpack:///./src/resources/session.js","webpack:///./src/resources/proofs.js","webpack:///./src/resources/patients.js","webpack:///./src/resources/captures.js","webpack:///./src/resources/notes.js","webpack:///./src/upload.js"],"names":["requestHeaders","headers","Headers","append","token","fullURL","path","urlParams","url","config","baseURL","paramsString","Object","keys","map","key","encodeURIComponent","join","length","handleUnauthenticated","response","status","Error","Promise","resolve","unauthorizedPromise","request","method","opts","body","JSON","stringify","postData","fetch","credentials","then","json","data","get","post","destroy","authToken","setToken","_token","isAuthenticated","loggedUser","isClinician","isPatient","setCurrentUser","currentUser","assign","user","clientConfig","storage","setConfigParam","paramName","value","login","email","password","create","hasOwnProperty","clinician","patient","logout","setApiBaseURL","upload","resources","proofs","patients","notes","captures","authPath","basePath","patientID","short","include","list","id","console","error","proofID","prepareEntity","capture","description","upload_s3_key","library_item_id","media","camera_type","metadata","note","only_visible_to_clinicians","TYPE_CAPTURE","TYPE_PROTOCOL_LOGO","TYPE_IM","uuidv4","replace","c","crypto","getRandomValues","Uint8Array","toString","getCredentialsFor","type","callback","guessMimeType","filename","ext","split","pop","toLowerCase","file","formData","FormData","xhr","XMLHttpRequest","creds","name","acl","AWSAccessKeyId","policy","signature","success_action_status","open","action_url","progress","addEventListener","event","lengthComputable","loaded","total","start","onloadstart","success","onloadend","e","onerror","send","protocolLogo","instructionalMedium"],"mappings":"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","file":"cp-api-client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2f02fc55b7340e3169fa","import config from './config';\nimport Auth from './auth';\n\nconst requestHeaders = () => {\n  let headers = new Headers();\n\n  headers.append('Content-Type', 'application/json');\n  headers.append('Accept', 'application/json');\n  headers.append('X-API-Session', Auth.token());\n\n  return headers;\n};\n\nconst fullURL = (path, urlParams = {}) => {\n  const url = config.config().baseURL + path;\n  const paramsString = Object.keys(urlParams).map((key) => {\n    return encodeURIComponent(key) + '=' + encodeURIComponent(urlParams[key]);\n  }).join('&');\n\n  return paramsString.length === 0 ? url : url + '?' + paramsString;\n};\n\n// Public\n\nconst handleUnauthenticated = (response) => {\n  if (response.status === 401) {\n    throw new Error('unauthenticated');\n  }\n  return new Promise((resolve) => {\n    resolve(response);\n  });\n};\n\nconst unauthorizedPromise = () => {\n  return new Promise(resolve => {\n    resolve({status: 401});\n  });\n};\n\n// opts:\n//   urlParams - params for url\n//   postData - post data to send\nconst request = (method, path, opts = {}) => {\n  const body = JSON.stringify(opts.postData);\n  let status = 0;\n\n  return fetch(fullURL(path, opts.urlParams), {\n    method: method,\n    headers: requestHeaders(),\n    credentials: 'same-origin',\n    body\n  })\n    .then(response => {\n      status = response.status;\n      return response.json();\n    })\n    .then(data => {\n      return new Promise((resolve) => {\n        resolve({ status, data });\n      });\n    });\n};\n\nconst get = (path, urlParams = {}, opts = {}) => {\n  return request('get', path, { urlParams, ...opts });\n};\n\nconst post = (path, postData = {}, opts = {}) => {\n  return request('post', path, { postData, ...opts });\n};\n\nconst destroy = (path, opts = {}) => {\n  return request('delete', path, opts);\n};\n\nexport default {\n  handleUnauthenticated,\n  unauthorizedPromise,\n  request,\n  get,\n  post,\n  destroy\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/request.js","let authToken = null;\n\nconst setToken = (_token) => { authToken = _token; };\nconst isAuthenticated = () => { authToken === null; };\nconst token = () => { return authToken; };\n\nexport default {\n  isAuthenticated,\n  token,\n  setToken\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/auth.js","let loggedUser = null;\n\nconst isAuthenticated = () => { return loggedUser !== null; };\nconst isClinician = () => {\n  return isAuthenticated() && ('specialty' in loggedUser);\n};\nconst isPatient = () => { return !isClinician(); };\nconst setCurrentUser = (currentUser) => { loggedUser = Object.assign({}, currentUser); };\nconst user = () => { return loggedUser; };\n\nexport default {\n  user,\n  setCurrentUser,\n  isAuthenticated,\n  isClinician,\n  isPatient\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/current_user.js","let clientConfig = {\n  baseURL: 'http://captureproof.makstep.ru/api/v1',\n  storage: 'mem' // mem (default), localstorage, cookie\n};\n\nconst config = () => { return clientConfig; };\n\nconst setConfigParam = (paramName, value) => {\n  clientConfig[paramName] = value;\n  return clientConfig;\n};\n\nexport default {\n  config,\n  setConfigParam\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","import session from './resources/session';\nimport proofs from './resources/proofs';\nimport patients from './resources/patients';\nimport captures from './resources/captures';\nimport notes from './resources/notes';\n\nimport upload from './upload';\n\nimport config from './config';\n\nimport CurrentUser from './current_user';\nimport Auth from './auth';\n\nconst login = (email, password, opts = {}) => {\n  return session.create(email, password)\n    .then(response => {\n      if (response.status === 200) {\n        Auth.setToken(response.data.token);\n\n        if (response.data.hasOwnProperty('clinician')) {\n          CurrentUser.setCurrentUser(response.data.clinician);\n        };\n\n        if (response.data.hasOwnProperty('patient')) {\n          CurrentUser.setCurrentUser(response.data.patient);\n        };\n      }\n      return new Promise(resolve => { resolve(response); });\n    });\n};\n\nconst logout = (opts = {}) => {\n  return session.destroy();\n};\n\nconst setApiBaseURL = (url) => {\n  config.setConfigParam('baseURL', url);\n};\n\nexport default {\n  setApiBaseURL,\n  login,\n  logout,\n  isAuthenticated: CurrentUser.isAuthenticated,\n  currentUser: {\n    user: CurrentUser.user,\n    isPatient: CurrentUser.isPatient,\n    isClinician: CurrentUser.isClinician\n  },\n  upload,\n  resources: {\n    proofs,\n    patients,\n    notes,\n    captures\n  }\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Request from '../request';\nimport Auth from '../auth';\n\nconst authPath = '/sessions';\n\nconst create = (email, password, opts = {}) => {\n  return Request.post(authPath, {\n    email,\n    password,\n    'app_id': 'captureproof api'\n  });\n};\n\nconst destroy = () => {\n  return Request.destroy(authPath + '/' + Auth.token());\n};\n\nexport default {\n  create,\n  destroy\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/session.js","import CurrentUser from '../current_user';\nimport Request from '../request';\n\nconst basePath = (patientID, path) => { return '/patients/' + patientID + '/proofs'; };\n\nconst urlParams = (opts = {}) => {\n  return (opts.hasOwnProperty('short') && opts.short) ?\n    {} :\n    { include: opts.include ? opts.include : 'captures,notes,surveys,proof_surveys' };\n};\n\n// Path: /patients/<patien_id>/proofs\nconst list = (patientID = null, opts = {}) => {\n  if (!CurrentUser.isAuthenticated()) {\n    return Request.unauthorizedPromise();\n  };\n\n  if (patientID === null && CurrentUser.isPatient()) {\n    patientID = CurrentUser.user().id;\n  }\n\n  if (CurrentUser.isPatient() && CurrentUser.user().id !== patientID) {\n    console.error('Error: unable to get proof list for other patient');\n    return [];\n  }\n\n  return Request.get(basePath(patientID), urlParams());\n};\n\n// Path: /patients/<patien_id>/proofs/<proof_id>\nconst get = (patientID, proofID) => {\n  if (!CurrentUser.isAuthenticated()) {\n    return Request.unauthorizedPromise();\n  };\n\n  if (patientID === null) {\n    if (CurrentUser.isClinician()) {\n      console.error('Error: no patientID provided.');\n      return [];\n    }\n    patientID = CurrentUser.user().id;\n  }\n\n  return Request.get(basePath(patientID) + '/' + proofID, urlParams());\n};\n\nexport default {\n  list,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/proofs.js","import Request from '../request';\nimport CurrentUser from '../current_user';\n\nconst basePath = '/patients';\n\nconst list = () => {\n  if (!CurrentUser.isAuthenticated()) {\n    return Request.unauthorizedPromise();\n  };\n\n  if (CurrentUser.isPatient()) {\n    console.error('Error: this call is not allowed for patient.');\n    return [];\n  }\n\n  return Request.get(basePath);\n};\n\nconst get = (patientID) => {\n  if (!CurrentUser.isAuthenticated()) {\n    return Request.unauthorizedPromise();\n  };\n\n  if (CurrentUser.isPatient()) {\n    console.error('Error: this call is not allowed for patient.');\n    return [];\n  }\n\n  return Request.get(basePath + patientID);\n};\n\nexport default {\n  list,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/patients.js","import { post } from '../request';\n\nconst basePath = (patientID, proofID) => {\n  return '/patients/' + patientID + '/proofs/' + proofID + '/captures';\n};\n\n/* eslint-disable camelcase */\nconst prepareEntity = (capture) => {\n  const {\n    description,\n    upload_s3_key,\n    library_item_id,\n    media,\n    camera_type,\n    metadata } = capture;\n\n  return {\n    description,\n    upload_s3_key,\n    library_item_id,\n    media,\n    camera_type,\n    metadata\n  };\n};\n/* eslint-enable camelcase */\n\nconst create = (patientID, proofID, capture, opts = {}) => {\n  return post(basePath(patientID, proofID), prepareEntity(capture));\n};\n\nexport default { create };\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/captures.js","import { post } from '../request';\n\nconst url = (patientID, proofID) =>\n  '/patients/' + patientID + '/proofs/' + proofID + '/notes';\n\n/* eslint-disable camelcase */\nconst prepareEntity = (note) => {\n  return {\n    body: note.body,\n    only_visible_to_clinicians: note.only_visible_to_clinicians\n  };\n};\n/* eslint-enable camelcase */\n\nconst create = (patientID, proofID, note, opts = {}) => {\n  return post(url(patientID, proofID), prepareEntity(note));\n};\n\nexport default { create };\n\n\n\n// WEBPACK FOOTER //\n// ./src/resources/notes.js","import { get } from './request';\n\nconst TYPE_CAPTURE = 'capture';\nconst TYPE_PROTOCOL_LOGO = 'protocol_logo';\nconst TYPE_IM = 'instructional_meduim';\n\nlet credentials = {};\n\ncredentials[TYPE_CAPTURE] = null;\ncredentials[TYPE_PROTOCOL_LOGO] = null;\ncredentials[TYPE_IM] = null;\n\n// Generates uuid\nconst uuidv4 = () => {\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n  );\n};\n\nconst getCredentialsFor = (type, callback) => {\n  if (credentials[type] !== null) {\n    return credentials[type];\n  }\n\n  let path = '';\n\n  switch (type) {\n    case TYPE_IM:\n      path = '/instructional_media/new';\n      break;\n    case TYPE_PROTOCOL_LOGO:\n      path = '/protocols/new';\n      break;\n    default: // Captures\n      path = '/patients/fake_patient_id/proofs/fake_proof_id/captures/new';\n  }\n\n  get(path)\n    .then((response) => {\n      if (response.status !== 200) { return; }\n      credentials[type] = response.data;\n      callback();\n    });\n\n  return null;\n};\n\n// Naive one, needs to be changed\nconst guessMimeType = (filename) => {\n  var ext = filename.split('.').pop();\n\n  switch (ext.toLowerCase()) {\n    case 'mpg':\n    case 'mpeg':\n      return 'video/mpeg';\n    case 'mov':\n      return 'video/quicktime';\n    case 'mp4':\n      return 'video/mp4';\n    case 'm4v':\n      return 'video/m4v';\n    case '3gp':\n      return 'video/3gp';\n    case 'avi':\n      return 'video/avi';\n    case 'wmv':\n      return 'video/x-ms-wmv';\n    case 'png':\n      return 'image/png';\n    default:\n      return 'image/jpg';\n  }\n};\n\nconst upload = (type, file, opts = {}) => {\n  let\n    formData = new FormData(),\n    xhr = new XMLHttpRequest();\n\n  // If creds is not loaded yet, then schedule function execution after\n  let creds = getCredentialsFor(type, () => { upload(type, file, opts); });\n\n  if (creds === null) { return ''; }\n\n  creds.key = creds.key.replace('{extension}', file.name.split('.').pop());\n  creds.key = creds.key.replace('{uuid}', uuidv4());\n\n  formData.append('utf8', '✓');\n  formData.append('x-amz-server-side-encryption', 'AES256');\n  formData.append('key', creds.key);\n  formData.append('acl', creds.acl);\n  formData.append('AWSAccessKeyId', creds.AWSAccessKeyId);\n  formData.append('policy', creds.policy);\n  formData.append('signature', creds.signature);\n  formData.append('success_action_status', creds.success_action_status);\n  formData.append('X-Requested-With', 'xhr');\n  formData.append('content-type', guessMimeType(file.name));\n  formData.append('file', file);\n\n  xhr.open('POST', creds.action_url);\n\n  if (typeof opts.progress === 'function') {\n    xhr.upload.addEventListener('progress', (event) => {\n      if (event.lengthComputable) {\n        opts.progress(event.loaded, event.total);\n      };\n    });\n  }\n\n  if (typeof opts.start === 'function') {\n    xhr.onloadstart = opts.start;\n  };\n\n  if (typeof opts.success === 'function') {\n    xhr.onloadend = (e) => {\n      opts.success(creds.key, e);\n    };\n  };\n\n  if (typeof opts.error === 'function') {\n    xhr.onerror = opts.error;\n  };\n\n  xhr.send(formData);\n\n  return creds.key;\n};\n\nconst capture = (file, opts = {}) => { upload(TYPE_CAPTURE, file, opts); };\nconst protocolLogo = (file, opts = {}) => { upload(TYPE_PROTOCOL_LOGO, file, opts); };\nconst instructionalMedium = (file, opts = {}) => { upload(TYPE_IM, file, opts); };\n\nexport default {\n  capture,\n  protocolLogo,\n  instructionalMedium\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/upload.js"],"sourceRoot":""}